# Neo4j Python チュートリアル

## 1. プロジェクトの概要

このプロジェクトは、Neo4jグラフデータベースをPythonから操作する基本的なCRUD操作（作成・読み取り・更新・削除）のサンプルを提供します。

![alt text](<CleanShot 2025-02-07 at 22.21.22@2x.png>)

## 2. 環境構築

### 必要な環境
- Docker
- Docker Compose

### セットアップ手順

1. プロジェクトのクローン後、以下のコマンドで環境を起動します：
```bash
docker-compose up -d
```

## 3. 基本的な操作方法

### プログラムの実行
```bash
docker exec -it my_python3 python /app/src/neo4j_test.py
```

### 実行結果の説明

プログラムは以下の操作を順番に実行します：

1. **ユーザーの作成**
   - 「田中」（25歳）と「鈴木」（30歳）という2人のユーザーを作成
   - Neo4jではこれらはUserラベルを持つノードとして保存

2. **ユーザー情報の取得**
   - データベースに保存されている全ユーザーの情報を表示
   - この時点で「田中」と「鈴木」の両方が表示される

3. **ユーザー情報の更新**
   - 「田中」の年齢を25歳から26歳に更新
   - 更新後の全ユーザー情報を表示

4. **ユーザーの削除**
   - 「鈴木」のデータを削除
   - 削除後は「田中」のデータのみが表示

## 4. コードの構成

### Neo4jCRUDクラスの主要メソッド

- `create_user(name, age)`: 新しいユーザーを作成
- `get_all_users()`: 全ユーザーの情報を取得
- `update_user_age(name, new_age)`: ユーザーの年齢を更新
- `delete_user(name)`: ユーザーを削除

### データの保存形式

Neo4jでは、データは以下の形式で保存されます：

```cypher
(u:User {name: "名前", age: 年齢})
```

## 5. 動作確認方法

1. **Neo4j Browser**
   - http://localhost:7474 にアクセス
   - ユーザー名: neo4j
   - パスワード: docker

2. **サンプルクエリ**
```cypher
// 全ユーザーの取得
MATCH (u:User) RETURN u;

// 特定のユーザーの検索
MATCH (u:User {name: "田中"}) RETURN u;
```

## 6. トラブルシューティング

1. **接続エラーが発生する場合**
   - Neo4jの起動を待つ必要がある場合があります（約10-15秒）
   - プログラムには自動リトライ機能が組み込まれています

2. **データが重複する場合**
   - 実行前に以下のクエリでデータをクリアできます：
```cypher
MATCH (n) DETACH DELETE n;
```
